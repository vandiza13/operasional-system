// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
  engineType = "wasm"
}

datasource db {
  provider = "mysql" 
  url      = env("DATABASE_URL")
}

// Hak Akses Sistem
enum Role {
  ADMIN
  TECHNICIAN
}

// Status Alur Uang Operasional
enum ReimbursementStatus {
  PENDING    
  APPROVED   
  REJECTED   
  PAID       
}

model User {
  id             String          @id @default(cuid())
  name           String
  email          String          @unique
  password       String          
  role           Role            @default(TECHNICIAN)
  
  reimbursements Reimbursement[] 
  
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
}

model Reimbursement {
  id             String              @id @default(cuid())
  amount         Decimal             @db.Decimal(10, 2) 
  description    String              @db.Text 
  
  // 4 SLOT FOTO SPESIFIK:
  receiptUrl     String              @db.Text // WAJIB: Foto Bon/Struk
  evidence1Url   String?             @db.Text // OPSIONAL: Tanda tanya (?) berarti boleh kosong
  evidence2Url   String?             @db.Text // OPSIONAL
  evidence3Url   String?             @db.Text // OPSIONAL

  status         ReimbursementStatus @default(PENDING)
  rejectionNote  String?             @db.Text

  userId         String
  user           User                @relation(fields: [userId], references: [id])

  createdAt      DateTime            @default(now()) 
  updatedAt      DateTime            @updatedAt
  approvedAt     DateTime?           
  paidAt         DateTime?           
}